.DEFAULT_GOAL := test
SRC_MODEL=../model/
INCLUDE=$(SRC_MODEL)
CFLAGS = -Wall  $(DEBUG) -I$(INCLUDE)
LFLAGS = -llog4cplus

TARGET_UTILVECTOR_TEST=UtilVectorTest
SOURCES_UTILVECTOR_TEST=$(SRC_MODEL)UtilVector.cc
SOURCES_UTILVECTOR_TEST+=UtilVectorTest.cc

INCLUDE_FILES=$(SRC_MODEL)UtilVector.hpp

TARGET_GRAPHXY_ITERATOR_TEST=GraphXYIteratorTest
SOURCES_GRAPHXY_ITERATOR_TEST=GraphXYIteratorTest.cc $(SRC_MODEL)GraphXYIterator.cpp
INCLUDE_FILES_GRAPHXY_ITERATOR_TEST=$(SRC_MODEL)GraphXYIterator.hpp

TARGET_PURGE_GRAPHXY_TEST=PurgeGraphXYTest
SOURCES_PURGE_GRAPHXY_TEST=PurgeGraphXYTest.cc $(SRC_MODEL)PurgeGraphXY.cc


$(TARGET_UTILVECTOR_TEST): $(SOURCES_UTILVECTOR_TEST) $(INCLUDE_FILES)
	g++ $(CFLAGS) $(LFLAGS) -L $GTEST_HOME/lib -lgtest -lgtest_main -lpthread $(SOURCES_UTILVECTOR_TEST) -o $(TARGET_UTILVECTOR_TEST)

$(TARGET_GRAPHXY_ITERATOR_TEST): $(SOURCES_GRAPHXY_ITERATOR_TEST) $(INCLUDE_FILES_GRAPHXY_ITERATOR_TEST)
	g++ $(CFLAGS) $(LFLAGS) -L $GTEST_HOME/lib -lgtest -lgtest_main -lpthread $(SOURCES_GRAPHXY_ITERATOR_TEST) -o $(TARGET_GRAPHXY_ITERATOR_TEST)

$(TARGET_PURGE_GRAPHXY_TEST): $(SOURCES_PURGE_GRAPHXY_TEST) 
	g++ $(CFLAGS) $(LFLAGS) -L $GTEST_HOME/lib -lgtest -lgtest_main -lpthread $(SOURCES_PURGE_GRAPHXY_TEST) -o $(TARGET_PURGE_GRAPHXY_TEST)


 
test: $(TARGET_UTILVECTOR_TEST) $(TARGET_GRAPHXY_ITERATOR_TEST) $(TARGET_PURGE_GRAPHXY_TEST)
	LD_LIBRARY_PATH=LD_LIBRARY_PATH:/usr/local/lib/ ./$(TARGET_UTILVECTOR_TEST)
	LD_LIBRARY_PATH=LD_LIBRARY_PATH:/usr/local/lib/ ./$(TARGET_GRAPHXY_ITERATOR_TEST)
	LD_LIBRARY_PATH=LD_LIBRARY_PATH:/usr/local/lib/ ./$(TARGET_PURGE_GRAPHXY_TEST)

test_iterator: $(TARGET_GRAPHXY_ITERATOR_TEST)
	LD_LIBRARY_PATH=LD_LIBRARY_PATH:/usr/local/lib/ ./$(TARGET_GRAPHXY_ITERATOR_TEST)

test_purge: $(TARGET_PURGE_GRAPHXY_TEST)
	LD_LIBRARY_PATH=LD_LIBRARY_PATH:/usr/local/lib/ ./$(TARGET_PURGE_GRAPHXY_TEST)	

clean:
	rm -Rf $(TARGET_UTILVECTOR_TEST)
	rm -Rf *.o
